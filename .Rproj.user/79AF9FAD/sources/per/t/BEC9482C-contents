
#'@export
test_that("LIM_simulator", {


  n <- 10
  nreps <- 50
  tau <- rep(0,n)
  omega <- matrix(0,n,n)
  beta <- seq(0,2,2/(nreps-1))
  X1 <- rep(c(-1,1),5)
  Hebb <- T
  e <- .001
  lambda <- .001

  set.seed(42)
  output <- LIM_simulator(n = n, nreps = nreps, tau = tau, omega = omega, beta = beta, X1 = X1, Hebb = T, e = e, lambda = lambda)

  expect_equal(output$`mean omega`,c(0, -1e-04, -0.0001998, -0.0002994004, -0.00035892135936, -0.00041828327680128,
                                     -0.000477486470407678, -0.00041700934369727, -0.000356572931400283,
                                     -0.000415780104897802, -0.000474908864048327, -0.000414435542915822,
                                     -0.000354002849065262, -0.000293611020602403, -0.00023325997579647,
                                     -0.000172949633080148, -0.00011267991104926, -5.24545512271612e-05,
                                     7.65035787529317e-06, -5.11002403208741e-05, -0.000109853337320649,
                                     -5.02654281679529e-05, 9.24148142195777e-06, 6.86693771926886e-05,
                                     0.000128018417171878, 0.000187288759071109, 0.000127182695783332,
                                     6.70782613989277e-05, 7.01403588329225e-06, -9.15902966123254e-05,
                                     -0.000190117420442952, -0.00028856247921476, -0.000386890647869025,
                                     -0.000445388514053384, -0.000503809384505373, -0.000601001292889821,
                                     -0.000658688293980078, -0.000716299921068155, -0.000773836324902055,
                                     -0.000870808671495276, -0.000930200775032583, -0.00102717825555562,
                                     -0.0011240417811176, -0.00122077906237166, -0.00127738720365678,
                                     -0.00137459256086987, -0.00143328183721223, -0.00149185373500191,
                                     -0.00155030848899601, -0.00160863867362959))

  expect_equal(output$configurations[1:50,],structure(c(-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                                                        1, 1, 1, 1, -1, -1, -1, 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1,
                                                        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                                                        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                                                        1, 1, 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                                                        1, 1, 1, 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, 1, 1,
                                                        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                                                        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                                                        -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, 1,
                                                        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, -1, 1,
                                                        1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                                                        -1, -1, -1, -1, -1, -1, -1, -1), .Dim = c(50L, 10L)))
})
